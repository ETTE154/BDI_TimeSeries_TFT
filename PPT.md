# PTT 작성 내용 요약

## TFT 모델 소개

### TFT 모델
  - TFT는 순환 신경망(RNN), 합성곱 신경망(CNN) 및 어텐션 메커니즘과 같은 **다양한 신경망 구조의 장점을 결합**하여 복잡한 시계열 데이터를 모델링합니다.

### TFT 모델의 구성요소

  1. **입력 인코딩**: TFT는 게이트가 있는 선형 유닛(GLU)과 dilated convolution의 조합을 사용하여 각 입력 특징을 개별적으로 처리합니다. 이를 통해 모델은 **복잡한 시간 패턴을 학습하고 다양한 특징 유형에 적응**할 수 있습니다.

  2. **시간적 융합**: 모델은 각각 장기 및 단기 시간 종속성을 모델링하기 위해 셀프 어텐션 및 로컬 어텐션 메커니즘의 조합을 사용합니다. 이를 통해 모델은 **전역 및 로컬 컨텍스트를 효과적으로 포착**할 수 있습니다.

  3. **출력 디코딩**: TFT는 인코딩된 입력 특징의 다양한 부분에 주목하여 다중 수평 예측을 생성하는 멀티 헤드 어텐션 메커니즘을 사용합니다. 이로 인해 더 **정확하고 해석 가능한 예측이 가능**해집니다.

## Dataset

| Feature | Description | Unit | Frequency |
| :-----: | :---------: | :--: | :-------: |
| BDI     | Baltic Dry Index | Points | Daily |
| SSEC    | Shanghai Stock Exchange Composite | Points | Daily |
| Nasdaq  | National Association of Securities Dealers Automated Quotations | Points | Daily |
| NOSB    | Manufacturers' New Orders: Ships and Boats | Millions of Dollars | Monthly |
| CRB     | Commodity Research Bureau Index | Points | Daily |
| Fed     | United States Fed Funds Rate | Percent | Monthly |
| OECD GDP growth | OECD GDP growth rate | Percent | Annual |
| Special Events | Subprime Mortgage, Covid-19, etc. | - | Occasional |
| Seasonality | Seasonal factors affecting shipping demand | - | Annual |

## Variable Selection Network 구조
  - Temporal Fusion Transformer (TFT) 모델의 Variable Selection Network는 입력 변수의 가변적인 중요도를 자동으로 학습하는 구조입니다. 이 네트워크는 각 입력 변수에 대해 가중치를 할당하고, 이 가중치를 이용하여 예측에 얼마나 영향력 있는지를 결정합니다. 이를 통해 모델은 불필요한 변수를 걸러내고, 관련성이 높은 변수에 집중할 수 있습니다.

## 결과 분석
### 1. Attention
![11](https://user-images.githubusercontent.com/109407983/234295377-867ac0ae-872c-40db-ad4b-7b5e275e0d70.png)
  - 먼저, BDI 예측에 있어서 최근의 경제 동향과 금융 상황이 큰 영향을 미치는 것으로 나타납니다. 이는 건화물 시장 참가자들이 BDI 예측 및 관련된 전략적 결정을 수립할 때 최근의 경제 데이터와 금융 상황을 반드시 고려해야 함을 의미합니다.

  - 또한, 이러한 결과는 BDI 예측 모델의 성능을 개선하기 위해 최근의 데이터를 더욱 집중적으로 분석하고 이해하는 것이 중요하다는 것을 시사합니다. 예를 들어, 최근 30주간의 데이터를 더 자세히 살펴보면, 특정 경제 이벤트나 금융 정책 변화가 BDI에 어떤 영향을 미쳤는지 파악할 수 있으며, 이를 바탕으로 더 정확한 예측을 수행할 수 있습니다.

  - 마지막으로, 이러한 결과는 건화물 시장 참가자들이 BDI 예측에 관한 민감도를 이해하고, 시장의 빠른 변화에 대응할 수 있는 유연한 전략을 개발하는 데 도움이 됩니다. 예를 들어, 기업들은 최근의 시장 동향을 반영하는 빠른 의사결정을 통해 경쟁력을 확보할 수 있으며, 선박 회사들은 선박 투자 및 운영 전략을 보다 신속하게 조정할 수 있습니다.

  - 요약하면, 최근 30주간의 데이터에 대한 높은 Attention 값은 BDI 예측에 있어 최근 경제 및 금융 상황이 중요하다는 것을 시사하며, 이를 통해 건화물 시장 참가자들은 더 정확한 예측과 전략적 의사결정을 수립할 수 있습니다.

### 2. Encoder variables importance
![13](https://user-images.githubusercontent.com/109407983/234295922-1a134fec-65f7-4155-ad75-32788abd5099.png)
  - TFT 모델을 이용하여 BDI를 예측한 결과, 인코더 변수 중요도가 CRB, BDI, NASDAQ 순으로 나타났습니다. 이러한 결과를 해석하면 다음과 같은 인사이트를 얻을 수 있습니다.

  **첫째**, CRB(Commodity Research Bureau) 지수가 가장 높은 중요도를 가지므로, 원자재 가격의 흐름이 BDI에 큰 영향을 미친다고 볼 수 있습니다. 이를 통해 선박 회사들은 원자재 가격의 변동에 주의를 기울이고, 원자재 가격의 상승세와 하락세에 따른 수요 변화에 대비할 수 있습니다.
  
  **둘째**, BDI 자체도 중요한 변수로, 건화물 시장의 과거 추세와 패턴이 미래 예측에 영향을 미친다는 것을 알 수 있습니다. 기업들은 BDI의 과거 데이터를 분석하여 시장의 변화를 이해하고, 이를 바탕으로 전략을 수립할 수 있습니다.
  
  **셋째**, NASDAQ 지수가 중요한 변수로 나타나, 미국 주식 시장의 흐름이 BDI에 영향을 미친다는 것을 알 수 있습니다. 이를 통해 선박 회사들은 글로벌 경제 상황과 주식 시장의 변동성에 주의를 기울이고, 이에 따른 건화물 시장의 변화에 대응할 수 있습니다.
  - 이러한 인사이트를 바탕으로, 건화물 수출입 기업들은 원자재 가격의 변동과 글로벌 경제 상황을 고려하여 물류 및 수송 비용에 대한 예측을 개선하고, 시장 변화에 따른 위험을 관리할 수 있습니다. 선박 회사들은 원자재 가격과 글로벌 경제 상황에 따른 수요 변화를 예측하고, 선박 투자 및 운영 전략을 보다 효과적으로 수립할 수 있습니다.

### 3. Prediction vs. Actual 
![new_pred](https://user-images.githubusercontent.com/109407983/234297188-04ebc77e-d053-4cab-b175-0ee3bbcda6d1.png)
  - TFT 모델을 이용하여 BDI를 예측한 결과에 따르면, 향후 6개월간 BDI가 급격하게 증가할 것으로 예상됩니다. 이러한 상황에서 선박 회사가 취할 전략은 다음과 같습니다.
#### 예시1)  
  1. 선박 용량 확보 및 확장: BDI가 급격하게 증가할 것이라는 예측이 있으므로, 선박 회사들은 수요 증가에 대비하여 선박 용량을 확보하거나 용량을 확장할 필요가 있습니다. 이를 위해 기존 선박의 성능을 개선하거나, 새로운 선박을 구매하거나 임대할 수 있습니다.
  2. 항로 최적화 및 효율적인 스케줄 관리: BDI 상승은 건화물 운송 수요가 높아질 것을 의미합니다. 이를 최대한 활용하기 위해 선박 회사들은 항로를 최적화하고 효율적인 스케줄 관리를 통해 운송 비용을 절감할 수 있습니다.
  3. 고객 관계 및 계약 협상: BDI의 급격한 상승은 선박 회사들에게 유리한 시장 상황을 제공합니다. 이를 기회로 삼아 기존 고객들과의 관계를 강화하고, 새로운 고객을 확보하는 데 주력할 수 있습니다. 또한, 운임료 협상에서 더 나은 조건을 이끌어 낼 수 있습니다.
  4. 위험 관리 및 헷지 전략: BDI가 급격하게 상승하는 동안 시장 변동성도 증가할 수 있으므로, 선박 회사들은 위험 관리 전략을 강화해야 합니다. 이에는 연료 가격 변동에 대한 헷지 전략, 환율 변동에 대한 대응 전략, 선박 운영 비용을 관리하는 전략 등이 포함됩니다.
  5. 지속 가능한 선박 운영: 선박 운영 비용과 환경 규제가 강화되고 있으므로, 선박 회사들은 친환경적인 기술과 연료를 도입하여 지속 가능한 선박 운영을 위한 전략을 세울 필요가 있습니다. 이를 통해 운영 비용을 절감하고 환경 규제를 준수할 수 있습니다.
#### 예시2)
  1. 선박 용량 확보: BDI 상승 예측에 따라 수요 증가에 대비하여 선박 용량을 확보합니다.
  2. 항로 최적화: 항로 효율성을 높여 수익성을 극대화하고 운영 비용을 절감합니다.
  3. 고객 관계 및 계약 협상: BDI 상승을 고려해 고객과의 계약을 협상하고 장기 계약을 확보합니다.
  4. 위험 관리 및 헷지 전략: BDI 변동성에 대비해 위험 관리 및 헷지 전략을 강화합니다.
  5. 지속 가능한 선박 운영: 환경 친화적인 선박 운영 전략을 통해 지속 가능한 경영을 추구합니다.
 #### 예시3)
  - 향후 6개월간 BDI가 급격하게 증가할 것이라는 예측에 따라 선박 회사들은 선박 용량 확보, 항로 최적화, 고객 관계 및 계약 협상, 위험 관리 및 헷지 전략, 그리고 지속 가능한 선박 운영 전략을 세워야 합니다.
